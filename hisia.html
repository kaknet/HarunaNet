<!DOCTYPE html>
<html lang="sw">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tathmini ya Hisia na Tabia</title>
  <link rel="icon" href="logo.png" type="image/png" />
  <script defer src="https://cdn.jsdelivr.net/npm/face-api.js"></script>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #0077be, #00c6ff);
      padding: 20px;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
    }

    header img {
      width: 80px;
      height: auto;
    }

    header h1 {
      margin: 10px 0 0;
      color: white;
    }

    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }

    .flip-card {
      background-color: transparent;
      width: 100%;
      height: 480px;
      perspective: 1000px;
    }

    .flip-card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.8s ease;
      transform-style: preserve-3d;
    }

    .flip-card:hover .flip-card-inner {
      transform: rotateY(180deg);
    }

    .flip-card-front, .flip-card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 8px 16px rgba(0,0,0,0.3);
    }

    .flip-card-front img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .flip-card-back {
      background-color: #f9f9f9;
      transform: rotateY(180deg);
      display: flex;
      flex-direction: column;
      overflow-y: auto;
    }

    .flip-card-back img {
      width: 100%;
      height: 180px;
      object-fit: cover;
    }

    .flip-card-back .content {
      padding: 16px;
      flex: 1;
    }

    .flip-card-back .content h3 {
      margin-top: 0;
      color: #0077be;
    }

    .flip-card-back .content p {
      font-size: 14px;
      color: #333;
      line-height: 1.6;
    }

    .camera-section {
      background: white;
      padding: 20px;
      border-radius: 12px;
      max-width: 600px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    video {
      width: 100%;
      border-radius: 10px;
      margin-bottom: 15px;
    }

    button {
      background-color: #0077be;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background-color: #005f99;
    }

    #spinner {
      display: none;
      text-align: center;
      margin-top: 10px;
      font-style: italic;
      color: #555;
    }

    #moodResult {
      text-align: center;
      margin-top: 10px;
      font-weight: bold;
      color: #333;
    }
  </style>
</head>
<body>

<header>
  <img src="logo.png" alt="HarunaNet Logo" />
  <h1>Tathmini ya Hisia na Tabia</h1>
</header>

<section class="gallery">
  <!-- Flip Card 1 -->
  <div class="flip-card">
    <div class="flip-card-inner">
      <div class="flip-card-front">
        <img src="intel2.jpg" alt="Picha ya Mbele 1" />
      </div>
      <div class="flip-card-back">
        <img src="Form.jpg" alt="Picha ya Nyuma 1" />
        <div class="content">
          <h3>Maelezo ya Hisia</h3>
          <p>
            Hii ni kadi ya kwanza ya hisia. Inaonyesha hali ya furaha au utulivu wa mteja. Maelezo haya yanaweza kuwa marefu, kwa hiyo unaweza kuburuta chini kuona yote. Tathmini hii husaidia kuelewa tabia ya mteja kwa undani zaidi.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Flip Card 2 -->
  <div class="flip-card">
    <div class="flip-card-inner">
      <div class="flip-card-front">
        <img src="intel3.jpg" alt="Picha ya Mbele 2" />
      </div>
      <div class="flip-card-back">
        <img src="Form2.jpg" alt="Picha ya Nyuma 2" />
        <div class="content">
          <h3>Maelezo ya Tabia</h3>
          <p>
            Hii ni kadi ya pili ya hisia. Inaweza kuonyesha hali ya hasira, huzuni, au kutokuwa na hisia. Maelezo haya yanaeleza jinsi ya kushughulikia tabia hiyo kwa njia ya kitaalamu na yenye huruma. Tumia scrollbar kusoma maelezo yote.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="camera-section">
  <video id="video" autoplay muted playsinline></video>
  <button onclick="captureMood()">üì∑ Tambua Hisia za Uso</button>
  <p id="spinner">‚è≥ Inatambua hisia...</p>
  <p id="moodResult">Hisia hazijachambuliwa bado.</p>
</section>

<script>
  const video = document.getElementById("video");
  let moodDetected = "Haijachambuliwa";

  Promise.all([
    faceapi.nets.tinyFaceDetector.loadFromUri("https://cdn.jsdelivr.net/npm/face-api.js/models"),
    faceapi.nets.faceExpressionNet.loadFromUri("https://cdn.jsdelivr.net/npm/face-api.js/models")
  ]).then(startVideo);

  function startVideo() {
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => video.srcObject = stream)
      .catch(err => console.error("Camera error:", err));
  }

  async function captureMood() {
    document.getElementById("spinner").style.display = "block";
    const detections = await faceapi.detectSingleFace(video, new faceapi.TinyFaceDetectorOptions()).withFaceExpressions();
    document.getElementById("spinner").style.display = "none";

    if (detections && detections.expressions) {
      const sorted = Object.entries(detections.expressions).sort((a, b) => b[1] - a[1]);
      moodDetected = sorted[0][0];
      document.getElementById("moodResult").innerText = "Hisia zilizogunduliwa: " + moodDetected;
    } else {
      document.getElementById("moodResult").innerText = "Uso haujatambuliwa.";
    }
  }
</script>

</body>
</html>
